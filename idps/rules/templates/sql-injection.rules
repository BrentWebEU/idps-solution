# SQL Injection Detection Rules Template
# These rules detect SQL injection attack patterns

# SQL Injection - Basic Patterns
alert http any any -> $HOME_NET any (msg:"SQL Injection Attempt - Basic Pattern"; flow:established,to_server; content:"' OR '1'='1"; http_uri; sid:1000201; rev:1;)

alert http any any -> $HOME_NET any (msg:"SQL Injection Attempt - UNION"; flow:established,to_server; content:"UNION SELECT"; http_uri; sid:1000202; rev:1;)

alert http any any -> $HOME_NET any (msg:"SQL Injection Attempt - Comment"; flow:established,to_server; content:"--"; http_uri; sid:1000203; rev:1;)

alert http any any -> $HOME_NET any (msg:"SQL Injection Attempt - Semicolon"; flow:established,to_server; content:";"; http_uri; content:"DROP"; http_uri; sid:1000204; rev:1;)

# SQL Injection - Time-based
alert http any any -> $HOME_NET any (msg:"SQL Injection Attempt - Time-based"; flow:established,to_server; content:"SLEEP"; http_uri; sid:1000205; rev:1;)

alert http any any -> $HOME_NET any (msg:"SQL Injection Attempt - WAITFOR"; flow:established,to_server; content:"WAITFOR"; http_uri; sid:1000206; rev:1;)

# SQL Injection - Error-based
alert http any any -> $HOME_NET any (msg:"SQL Injection Attempt - Error-based"; flow:established,to_server; content:"SQL syntax"; http_client_body; sid:1000207; rev:1;)

alert http any any -> $HOME_NET any (msg:"SQL Injection Attempt - MySQL Error"; flow:established,to_server; content:"mysql_fetch"; http_client_body; sid:1000208; rev:1;)
